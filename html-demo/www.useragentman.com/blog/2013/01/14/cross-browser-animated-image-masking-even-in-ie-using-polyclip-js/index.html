<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">



<html xmlns="http://www.w3.org/1999/xhtml" class="responsive has-jquery post-5621" lang="en">
<head profile="http://gmpg.org/xfn/11">
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<meta name="google-site-verification" content="mPcIUE2BmItw8B1dH4oiDBff9npX4HZuKGtn4AIU7YA" />
	<meta name="theme-color" content="#9C6F39" />

	<title>  Cross-Browser Animated Image Masking (Even in IE) Using polyClip.js</title>

	<meta name="generator" content="WordPress 4.7.5" /> <!-- leave this for stats -->

	<meta http-equiv="imagetoolbar" content="no">

	<link href="/css/global.css" rel="stylesheet" type="text/css" media="all" />

	

	<link rel="alternate" type="application/rss+xml" title="User Agent Man RSS Feed" href="http://www.useragentman.com/blog/feed/" />
	<link rel="pingback" href="http://www.useragentman.com/blog/xmlrpc.php" />

	<script>
	  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
	
	  ga('create', 'UA-56528829-1', 'auto');
	  ga('send', 'pageview');
	
	</script>
	
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />	
	<script type="text/javascript" src="/shared/js/EventHelpers.js"></script>
	
	<link rel="stylesheet" href="/tests/polyClip-2.1/css/polyclip-animation-example1.css" />
<link rel="stylesheet" href="/tests/polyClip-2.1/css/polyclip-animation-example2.css" />
<link rel="stylesheet" href="http://www.useragentman.com/tests/polyClip-2.1/css/blog-modsquad.css" />

<link rel="stylesheet" href="/css/5621.css" />
<!--[if lt IE 9 ]>
	<script src="/tests/polyClip-2.1/js/libs/html5.js"></script>
	<script src="/tests/polyClip-2.1/js/libs/excanvas.compiled.js"></script>
  <![endif]-->
  <script src="/tests/polyClip-2.1/js/libs/jquery-1.8.3.min.js"></script>
  <script src="/tests/polyClip-2.1/js/libs/jquery.easing.1.3.js"></script>
  
  
  <script src="/tests/polyClip-2.1/js/libs/sylvester.js"></script>
  <script src="/tests/polyClip-2.1/js/libs/jshashtable-2.1.js"></script>
  <script src="/tests/polyClip-2.1/js/Silk.js"></script>
 
  <script src="/tests/polyClip-2.1/js/polyclip.js"></script>
  <script src="/tests/polyClip-2.1/js/examples/polyclip-animation-example1.js"></script>
  <script src="/tests/polyClip-2.1/js/examples/polyclip-animation-example2.js"></script>
  
  <!-- This is for the third, Mod Squad example -->
  <script src="/tests/polyClip-2.1/js/libs/querystring.js"></script>
  <script src="/tests/polyClip-2.1/js/examples/inblog-modsquad.js"></script>
  
  
<!-- ID is 5621 --><script src="/js/resp.js"></script> 

	<!-- Needed for Forms Feature Detection -->
	<script type="text/javascript" src="/tests/html5Forms/shared/js/modernizr.com/Modernizr-2.5.3.forms.js">
	</script>
	
	<!-- Needed for Validation --> 
	<script type="text/javascript" src="/tests/html5Forms.beta/shared/js/html5Forms.js" data-webforms2-support="validation,range,color,placeholder" data-webforms2-force-js-validation="true">
</script>
	<script type="text/javascript" src="/js/useragentman.js"></script>
	
	<link rel='dns-prefetch' href='//www.useragentman.com' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel="alternate" type="application/rss+xml" title="User Agent Man &raquo; Cross-Browser Animated Image Masking (Even in IE) Using polyClip.js Comments Feed" href="http://www.useragentman.com/blog/2013/01/14/cross-browser-animated-image-masking-even-in-ie-using-polyclip-js/feed/" />
		<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2.2.1\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2.2.1\/svg\/","svgExt":".svg","source":{"concatemoji":"http:\/\/www.useragentman.com\/blog\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.7.5"}};
			!function(a,b,c){function d(a){var b,c,d,e,f=String.fromCharCode;if(!k||!k.fillText)return!1;switch(k.clearRect(0,0,j.width,j.height),k.textBaseline="top",k.font="600 32px Arial",a){case"flag":return k.fillText(f(55356,56826,55356,56819),0,0),!(j.toDataURL().length<3e3)&&(k.clearRect(0,0,j.width,j.height),k.fillText(f(55356,57331,65039,8205,55356,57096),0,0),b=j.toDataURL(),k.clearRect(0,0,j.width,j.height),k.fillText(f(55356,57331,55356,57096),0,0),c=j.toDataURL(),b!==c);case"emoji4":return k.fillText(f(55357,56425,55356,57341,8205,55357,56507),0,0),d=j.toDataURL(),k.clearRect(0,0,j.width,j.height),k.fillText(f(55357,56425,55356,57341,55357,56507),0,0),e=j.toDataURL(),d!==e}return!1}function e(a){var c=b.createElement("script");c.src=a,c.defer=c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var f,g,h,i,j=b.createElement("canvas"),k=j.getContext&&j.getContext("2d");for(i=Array("flag","emoji4"),c.supports={everything:!0,everythingExceptFlag:!0},h=0;h<i.length;h++)c.supports[i[h]]=d(i[h]),c.supports.everything=c.supports.everything&&c.supports[i[h]],"flag"!==i[h]&&(c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&c.supports[i[h]]);c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&!c.supports.flag,c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.everything||(g=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",g,!1),a.addEventListener("load",g,!1)):(a.attachEvent("onload",g),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),f=c.source||{},f.concatemoji?e(f.concatemoji):f.wpemoji&&f.twemoji&&(e(f.twemoji),e(f.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
<link rel='stylesheet' id='sedlex_styles-css'  href='http://www.useragentman.com/blog/wp-content/plugins//shorten-url/core/load-styles.php?c=0&#038;load=af360b0a0cb67a7e958272a2269faf0e&#038;ver=20170907' type='text/css' media='all' />
<link rel='https://api.w.org/' href='http://www.useragentman.com/blog/wp-json/' />
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="http://www.useragentman.com/blog/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="http://www.useragentman.com/blog/wp-includes/wlwmanifest.xml" /> 
<link rel='prev' title='CSS3 Pseudo-Classes and HTML5 Forms: Their Limitations and a Possible Solution' href='http://www.useragentman.com/blog/2012/11/05/css3-pseudo-classes-and-html5-forms-their-limitations-and-a-possible-solution/' />
<link rel='next' title='Animating Circular Paths Using CSS3 Animations.' href='http://www.useragentman.com/blog/2013/03/03/animating-circular-paths-using-css3-transitions/' />
<link rel="canonical" href="http://www.useragentman.com/blog/2013/01/14/cross-browser-animated-image-masking-even-in-ie-using-polyclip-js/" />
<link rel='shortlink' href='http://useragentman.com/blog/YK2eU' />
<link rel="alternate" type="application/json+oembed" href="http://www.useragentman.com/blog/wp-json/oembed/1.0/embed?url=http%3A%2F%2Fwww.useragentman.com%2Fblog%2F2013%2F01%2F14%2Fcross-browser-animated-image-masking-even-in-ie-using-polyclip-js%2F" />
<link rel="alternate" type="text/xml+oembed" href="http://www.useragentman.com/blog/wp-json/oembed/1.0/embed?url=http%3A%2F%2Fwww.useragentman.com%2Fblog%2F2013%2F01%2F14%2Fcross-browser-animated-image-masking-even-in-ie-using-polyclip-js%2F&#038;format=xml" />
	

	
	     
		<link href="/css/resp.css" rel="stylesheet" type="text/css" media="all" />
		<style type="text/css">
			@media only screen and (max-width: 768px) {
				  blockquote.code pre, .tableContainer .tableWrap, .wideImageContainer .wideImageWrap {
				    mask: url("#masking");
				}
				
				  blockquote.code.scrolled-to-end pre, .tableContainer.scrolled-to-end .tableWrap, .wideImageContainer.scrolled-to-end .wideImageWrap {
					mask: none;
				}
			}
		</style>
		
		
		
  </head>

<!-- variation of http://paulirish.com/2008/conditional-stylesheets-vs-css-hacks-answer-neither/ -->

<!--[if lt IE 7 ]> <body class="ie6 ie8down ie9down custom oldIE"> <![endif]-->
<!--[if IE 7 ]>    <body class="ie7 ie8down ie9down custom oldIE"> <![endif]-->
<!--[if IE 8 ]>    <body class="ie8 ie8down ie9down custom oldIE"> <![endif]-->
<!--[if IE 9 ]>    <body class="ie9 ie9down custom oldIE"> <![endif]-->
<!--[if (gt IE 9) ]><body class="modern custom"> <![endif]-->
<!--[!(IE)]><!--> <body class="notIE modern custom"> <!--<![endif]-->
  
		
<!-- This is the masking filter for Firefox -- had trouble with the CSS data url .. must look into -->
<svg width="0" height="0">
  <defs>
    <linearGradient id="gradient" x1="0" y1="00%" x2 ="100%" y2="0%">
      <stop stop-color="rgb(255, 255, 255)" offset="0"/>
      <stop stop-color="rgb(255, 255, 255)" offset="0.8"/>
      <stop stop-color="rgb(128, 128, 128)" offset="0.9"/>
      <stop stop-color="black" offset="1"/>
    </linearGradient>

    <mask id="masking" maskUnits="objectBoundingBox" maskContentUnits="objectBoundingBox">
      <rect y="0" width="1" height="1" fill="url(#gradient)" />
     
    </mask>
  </defs>
</svg>
	<a href="#content" class="bypass-block-link visually-hidden visible-when-focused">
	Skip Navigation
</a>
<div id="pageContainer" class="designElement">
            <div id="head" class="designElement">
                <form method="get" id="search" action="https://www.google.com/search">
                	<input type="hidden" name="as_sitesearch" value="useragentman.com">
                    <label for="search-q"><input type="text" id="search-q" name="q"></label> 
                    <input type="submit" value="Search">
                </form>
				

                <h1>User Agent Man </h1>

                <h2>Discoveries of a Client Side Web Developer	</h2>
            </div>
			<a href="http://www.useragentman.com/blog/2012/01/23/help-free-saeed-malekpour-sentenced-to-death-for-writing-code/" id="freeSaeed"><img src="/images/freeSaeed.jpg" alt="Free Saeed Malekpour, Website Developer" /></a>
	<ul id="mainMenu">
		<li><a href="http://www.useragentman.com/blog">Home</a></li>
		
		<li><a href="http://www.useragentman.com/blog/about-me/">About</a></li>
        <li><a href="http://www.useragentman.com/blog/current-projects/">Current Projects</a></li>
        <li><a href="http://www.useragentman.com/blog/tools/">Development Tools</a></li>
		<li><a href="http://www.useragentman.com/blog/the-infamous-zoltan-faq/">FAQ</a></li>
		<li><a href="http://www.useragentman.com/blog/acknowledgments/">Acknowledgments</a></li>
                
		<li class="rss"><a href="http://www.useragentman.com/blog/feed/">RSS</a></li>
	</ul>
	


	<div id="content_box">

		<div id="sideNav"> <!--  class="stickyObject-node" -->

<h2>Contact Me</h2>

<a href="http://twitter.com/zoltandulac"><img alt="Twitter:" src="/images/logos/twitter.png" style="position: relative; top: 4px"/></a> <a href="http://twitter.com/zoltandulac">@zoltandulac</a>
<br />
<a href="https://plus.google.com/116427162199664972782"><img alt="Google+:" src="/images/logos/google-plus.png" style="position: relative; top: 4px"/></a> <a href="https://plus.google.com/116427162199664972782">Zoltan Hawryluk</a>
<br />
<a href="https://instagram.com/zoltandulac/"><img alt="Instagram:" src="/images/logos/instagram.png" style="position: relative; top: 4px"/></a> <a href="https://instagram.com/zoltandulac/">@zoltandulac</a>
<br />
<script type="text/javascript">
<!--
// Email obfuscator script 2.1 by Tim Williams, University of Arizona
// Random encryption key feature by Andrew Moulden, Site Engineering Ltd
// This code is freeware provided these four comment lines remain intact
// A wizard to generate this code is at http://www.jottings.com/obfuscator/
{ coded = "k93sug.iW3uK@CUuw3.K9U"
  key = "GJ3D0Nn8WP4wRHAM9YZ2QOcELtapgdFzm1hjfqeSx5lXK7vsubCiykUIoBTr6V"
  shift=coded.length
  link=""
  for (i=0; i<coded.length; i++) {
    if (key.indexOf(coded.charAt(i))==-1) {
      ltr = coded.charAt(i)
      link += (ltr)
    }
    else {     
      ltr = (key.indexOf(coded.charAt(i))-shift+key.length) % key.length
      link += (key.charAt(ltr))
    }
  }
document.write("<a href='mailto:"+link+"'><img src='/images/logos/email.png' /> email me</a>")
}
//-->
</script><noscript>Sorry, you need Javascript on to email me.</noscript>

<h2>Most Popular Posts</h2>

<li class=""><a href='http://www.useragentman.com/blog/2010/03/09/cross-browser-css-transforms-even-in-ie/' ><span class='title'>Cross Browser CSS Transforms &#8211; even in IE</span></a></li>

<li class="category-box-shadow category-css category-css3 category-gradients category-ie-visual-filters category-javascript category-polyfills category-transform"><a href='http://www.useragentman.com/blog/2009/11/29/how-to-detect-font-smoothing-using-javascript/' ><span class='title'>How to Detect Font-Smoothing Using JavaScript</span></a></li>

<li class="category-font-face category-cleartype-technologies category-css category-css3 category-fonts category-javascript"><a href='http://www.useragentman.com/blog/2010/01/10/cross-browser-html5-drag-and-drop/' ><span class='title'>Cross Browser HTML5 Drag and Drop</span></a></li>

<li class="category-drag-and-drop category-html5 category-javascript"><a href='http://www.useragentman.com/blog/2009/09/20/font-face-in-depth/' ><span class='title'>@font-face in Depth</span></a></li>

<li class="category-font-face category-cleartype-technologies category-converting category-css category-fontforge-fonts category-fonts"><a href='http://www.useragentman.com/blog/2011/02/27/installing-cygwin-and-fontforge-for-windows/' ><span class='title'>Installing Cygwin and FontForge for Windows</span></a></li>

<li class="category-font-face category-converting category-cygwin category-fontforge-fonts category-fonts"><a href='http://www.useragentman.com/blog/2011/01/07/css3-matrix-transform-for-the-mathematically-challenged/' ><span class='title'>The CSS3 <code>matrix()</code> Transform for the Mathematically Challenged</span></a></li>

<li class="category-css category-css3 category-drag-and-drop category-math category-transform"><a href='http://www.useragentman.com/blog/2012/01/03/cross-browser-html5-progress-bars-in-depth/' ><span class='title'>Cross Browser HTML5 Progress Bars In Depth</span></a></li>
				<h2>Categories</h2>
			<ul>
					<li class="cat-item cat-item-171"><a href="http://www.useragentman.com/blog/category/3d/" >3d</a>
</li>
	<li class="cat-item cat-item-191"><a href="http://www.useragentman.com/blog/category/accessibility/" >accessibility</a>
</li>
	<li class="cat-item cat-item-123"><a href="http://www.useragentman.com/blog/category/color/" >Color</a>
</li>
	<li class="cat-item cat-item-96"><a href="http://www.useragentman.com/blog/category/cygwin/" >Cygwin</a>
</li>
	<li class="cat-item cat-item-77"><a href="http://www.useragentman.com/blog/category/internationalization/" >Internationalization</a>
</li>
	<li class="cat-item cat-item-175"><a href="http://www.useragentman.com/blog/category/localization/" >Localization</a>
</li>
	<li class="cat-item cat-item-95"><a href="http://www.useragentman.com/blog/category/math/" >math</a>
</li>
	<li class="cat-item cat-item-174"><a href="http://www.useragentman.com/blog/category/server-side-tech/" >server side tech</a>
</li>
	<li class="cat-item cat-item-6"><a href="http://www.useragentman.com/blog/category/technologies/" >Technologies</a>
<ul class='children'>
	<li class="cat-item cat-item-51"><a href="http://www.useragentman.com/blog/category/technologies/cleartype-technologies/" >ClearType</a>
</li>
	<li class="cat-item cat-item-9"><a href="http://www.useragentman.com/blog/category/technologies/css/" >CSS</a>
	<ul class='children'>
	<li class="cat-item cat-item-38"><a href="http://www.useragentman.com/blog/category/technologies/css/css3/" >CSS3</a>
		<ul class='children'>
	<li class="cat-item cat-item-152"><a href="http://www.useragentman.com/blog/category/technologies/css/css3/animation-css3/" >animation</a>
</li>
	<li class="cat-item cat-item-98"><a href="http://www.useragentman.com/blog/category/technologies/css/css3/border-image/" >border-image</a>
</li>
	<li class="cat-item cat-item-126"><a href="http://www.useragentman.com/blog/category/technologies/css/css3/box-shadow/" >box-shadow</a>
</li>
	<li class="cat-item cat-item-140"><a href="http://www.useragentman.com/blog/category/technologies/css/css3/cursor/" >cursor</a>
</li>
	<li class="cat-item cat-item-210"><a href="http://www.useragentman.com/blog/category/technologies/css/css3/flex-layout/" >flex-layout</a>
</li>
	<li class="cat-item cat-item-125"><a href="http://www.useragentman.com/blog/category/technologies/css/css3/gradients/" >gradients</a>
</li>
	<li class="cat-item cat-item-122"><a href="http://www.useragentman.com/blog/category/technologies/css/css3/hslhsla/" >hsl/hsla</a>
</li>
	<li class="cat-item cat-item-59"><a href="http://www.useragentman.com/blog/category/technologies/css/css3/matrix/" >matrix</a>
</li>
	<li class="cat-item cat-item-173"><a href="http://www.useragentman.com/blog/category/technologies/css/css3/matrix3d/" >matrix3d</a>
</li>
	<li class="cat-item cat-item-209"><a href="http://www.useragentman.com/blog/category/technologies/css/css3/order/" >order</a>
</li>
	<li class="cat-item cat-item-146"><a href="http://www.useragentman.com/blog/category/technologies/css/css3/psuedo-classes/" >psuedo-classes</a>
</li>
	<li class="cat-item cat-item-124"><a href="http://www.useragentman.com/blog/category/technologies/css/css3/rgbrgba/" >rgb/rgba</a>
</li>
	<li class="cat-item cat-item-147"><a href="http://www.useragentman.com/blog/category/technologies/css/css3/standard-proposal/" >standard proposal</a>
</li>
	<li class="cat-item cat-item-99"><a href="http://www.useragentman.com/blog/category/technologies/css/css3/text-shadow/" >text-shadow</a>
</li>
	<li class="cat-item cat-item-41"><a href="http://www.useragentman.com/blog/category/technologies/css/css3/transform/" >transform</a>
</li>
	<li class="cat-item cat-item-172"><a href="http://www.useragentman.com/blog/category/technologies/css/css3/transform3d-css3/" >transform3d</a>
</li>
	<li class="cat-item cat-item-153"><a href="http://www.useragentman.com/blog/category/technologies/css/css3/transition/" >transition</a>
</li>
	<li class="cat-item cat-item-160"><a href="http://www.useragentman.com/blog/category/technologies/css/css3/viewport-units/" >viewport units</a>
</li>
		</ul>
</li>
	<li class="cat-item cat-item-120"><a href="http://www.useragentman.com/blog/category/technologies/css/ie-visual-filters/" >IE Visual Filters</a>
</li>
	</ul>
</li>
	<li class="cat-item cat-item-10"><a href="http://www.useragentman.com/blog/category/technologies/fonts/" >Fonts</a>
	<ul class='children'>
	<li class="cat-item cat-item-14"><a href="http://www.useragentman.com/blog/category/technologies/fonts/font-face/" >@font-face</a>
</li>
	<li class="cat-item cat-item-121"><a href="http://www.useragentman.com/blog/category/technologies/fonts/converting/" >converting</a>
</li>
	<li class="cat-item cat-item-97"><a href="http://www.useragentman.com/blog/category/technologies/fonts/fontforge-fonts/" >FontForge</a>
</li>
	</ul>
</li>
	<li class="cat-item cat-item-8"><a href="http://www.useragentman.com/blog/category/technologies/html/" >HTML</a>
	<ul class='children'>
	<li class="cat-item cat-item-50"><a href="http://www.useragentman.com/blog/category/technologies/html/forms/" >Forms</a>
</li>
	<li class="cat-item cat-item-35"><a href="http://www.useragentman.com/blog/category/technologies/html/html5/" >HTML5</a>
		<ul class='children'>
	<li class="cat-item cat-item-132"><a href="http://www.useragentman.com/blog/category/technologies/html/html5/canvas/" >canvas</a>
</li>
	<li class="cat-item cat-item-49"><a href="http://www.useragentman.com/blog/category/technologies/html/html5/custom-data-attributes/" >Custom Data Attributes</a>
</li>
	<li class="cat-item cat-item-60"><a href="http://www.useragentman.com/blog/category/technologies/html/html5/drag-and-drop/" >Drag and Drop</a>
</li>
	<li class="cat-item cat-item-118"><a href="http://www.useragentman.com/blog/category/technologies/html/html5/events-html5/" >Events</a>
</li>
	<li class="cat-item cat-item-145"><a href="http://www.useragentman.com/blog/category/technologies/html/html5/forms-html5/" >forms</a>
</li>
	<li class="cat-item cat-item-143"><a href="http://www.useragentman.com/blog/category/technologies/html/html5/progress/" >progress</a>
</li>
	<li class="cat-item cat-item-200"><a href="http://www.useragentman.com/blog/category/technologies/html/html5/pushstate/" >pushState</a>
</li>
	<li class="cat-item cat-item-76"><a href="http://www.useragentman.com/blog/category/technologies/html/html5/ruby/" >Ruby</a>
</li>
		</ul>
</li>
	</ul>
</li>
	<li class="cat-item cat-item-23"><a href="http://www.useragentman.com/blog/category/technologies/images/" >Images</a>
</li>
	<li class="cat-item cat-item-7"><a href="http://www.useragentman.com/blog/category/technologies/javascript/" >JavaScript</a>
	<ul class='children'>
	<li class="cat-item cat-item-36"><a href="http://www.useragentman.com/blog/category/technologies/javascript/animation/" >animation</a>
</li>
	<li class="cat-item cat-item-109"><a href="http://www.useragentman.com/blog/category/technologies/javascript/events/" >Events</a>
</li>
	<li class="cat-item cat-item-133"><a href="http://www.useragentman.com/blog/category/technologies/javascript/jquery/" >jQuery</a>
</li>
	<li class="cat-item cat-item-119"><a href="http://www.useragentman.com/blog/category/technologies/javascript/polyfills/" >Polyfills</a>
</li>
	<li class="cat-item cat-item-144"><a href="http://www.useragentman.com/blog/category/technologies/javascript/requestanimationframe/" >requestAnimationFrame</a>
</li>
	</ul>
</li>
	<li class="cat-item cat-item-11"><a href="http://www.useragentman.com/blog/category/technologies/xml/" >XML</a>
	<ul class='children'>
	<li class="cat-item cat-item-13"><a href="http://www.useragentman.com/blog/category/technologies/xml/svg/" >SVG</a>
</li>
	<li class="cat-item cat-item-134"><a href="http://www.useragentman.com/blog/category/technologies/xml/vml/" >VML</a>
</li>
	</ul>
</li>
</ul>
</li>
	<li class="cat-item cat-item-170"><a href="http://www.useragentman.com/blog/category/transform3d/" >transform3d</a>
</li>
	<li class="cat-item cat-item-1"><a href="http://www.useragentman.com/blog/category/uncategorized/" >Uncategorized</a>
</li>
	<li class="cat-item cat-item-179"><a href="http://www.useragentman.com/blog/category/utf8/" >utf8</a>
</li>
			</ul>
			<!--
			<h2>Archives</h2>
			<ul>
					<li><a href='http://www.useragentman.com/blog/2017/04/'>April 2017</a></li>
	<li><a href='http://www.useragentman.com/blog/2017/02/'>February 2017</a></li>
	<li><a href='http://www.useragentman.com/blog/2017/01/'>January 2017</a></li>
	<li><a href='http://www.useragentman.com/blog/2016/12/'>December 2016</a></li>
	<li><a href='http://www.useragentman.com/blog/2016/05/'>May 2016</a></li>
	<li><a href='http://www.useragentman.com/blog/2015/11/'>November 2015</a></li>
	<li><a href='http://www.useragentman.com/blog/2015/10/'>October 2015</a></li>
	<li><a href='http://www.useragentman.com/blog/2015/07/'>July 2015</a></li>
	<li><a href='http://www.useragentman.com/blog/2015/01/'>January 2015</a></li>
	<li><a href='http://www.useragentman.com/blog/2014/09/'>September 2014</a></li>
	<li><a href='http://www.useragentman.com/blog/2014/05/'>May 2014</a></li>
	<li><a href='http://www.useragentman.com/blog/2013/09/'>September 2013</a></li>
	<li><a href='http://www.useragentman.com/blog/2013/05/'>May 2013</a></li>
	<li><a href='http://www.useragentman.com/blog/2013/04/'>April 2013</a></li>
	<li><a href='http://www.useragentman.com/blog/2013/03/'>March 2013</a></li>
	<li><a href='http://www.useragentman.com/blog/2013/01/'>January 2013</a></li>
	<li><a href='http://www.useragentman.com/blog/2012/11/'>November 2012</a></li>
	<li><a href='http://www.useragentman.com/blog/2012/09/'>September 2012</a></li>
	<li><a href='http://www.useragentman.com/blog/2012/08/'>August 2012</a></li>
	<li><a href='http://www.useragentman.com/blog/2012/05/'>May 2012</a></li>
	<li><a href='http://www.useragentman.com/blog/2012/01/'>January 2012</a></li>
	<li><a href='http://www.useragentman.com/blog/2011/12/'>December 2011</a></li>
	<li><a href='http://www.useragentman.com/blog/2011/10/'>October 2011</a></li>
	<li><a href='http://www.useragentman.com/blog/2011/08/'>August 2011</a></li>
	<li><a href='http://www.useragentman.com/blog/2011/06/'>June 2011</a></li>
	<li><a href='http://www.useragentman.com/blog/2011/05/'>May 2011</a></li>
	<li><a href='http://www.useragentman.com/blog/2011/04/'>April 2011</a></li>
	<li><a href='http://www.useragentman.com/blog/2011/03/'>March 2011</a></li>
	<li><a href='http://www.useragentman.com/blog/2011/02/'>February 2011</a></li>
	<li><a href='http://www.useragentman.com/blog/2011/01/'>January 2011</a></li>
	<li><a href='http://www.useragentman.com/blog/2010/10/'>October 2010</a></li>
	<li><a href='http://www.useragentman.com/blog/2010/09/'>September 2010</a></li>
	<li><a href='http://www.useragentman.com/blog/2010/08/'>August 2010</a></li>
	<li><a href='http://www.useragentman.com/blog/2010/07/'>July 2010</a></li>
	<li><a href='http://www.useragentman.com/blog/2010/06/'>June 2010</a></li>
	<li><a href='http://www.useragentman.com/blog/2010/05/'>May 2010</a></li>
	<li><a href='http://www.useragentman.com/blog/2010/04/'>April 2010</a></li>
	<li><a href='http://www.useragentman.com/blog/2010/03/'>March 2010</a></li>
	<li><a href='http://www.useragentman.com/blog/2010/01/'>January 2010</a></li>
	<li><a href='http://www.useragentman.com/blog/2009/11/'>November 2009</a></li>
	<li><a href='http://www.useragentman.com/blog/2009/10/'>October 2009</a></li>
	<li><a href='http://www.useragentman.com/blog/2009/09/'>September 2009</a></li>
			</ul>
			-->
		
</div>

		<div id="content" class="posts bypass-block-target" tabindex="-1" role="main">

		
		
<div class="navigation">
	<span class="previous">&laquo; <a href="http://www.useragentman.com/blog/2012/11/05/css3-pseudo-classes-and-html5-forms-their-limitations-and-a-possible-solution/" rel="prev">CSS3 Pseudo-Classes and HTML5 Forms: Their Limitations and a Possible Solution</a></span>
	<span class="next"><a href="http://www.useragentman.com/blog/2013/03/03/animating-circular-paths-using-css3-transitions/" rel="next">Animating Circular Paths Using CSS3 Animations.</a> &raquo;</span>
</div>


			<h1>Cross-Browser <em>Animated</em> Image Masking (Even in IE) Using polyClip.js</h1>
			<h4 class="meta">January 14th, 2013 by zoltan &middot; <a href="http://www.useragentman.com/blog/2013/01/14/cross-browser-animated-image-masking-even-in-ie-using-polyclip-js/#comments">No Comments</a></h4>
			<div class="entry">
				<p><!-- TODO: compress polyclip.js and Silk.js --></p>

<dl style="width: 425px " class="wp-caption alignleft">
<dt class="wp-caption-dt">
  <div id="example1" class="clipParent">
    <img id="dad1960" 
         src="/tests/polyClip-2.1/images/dad-circa-1960.jpg" 
         alt="Dad circa 1960" />
    <img id="dad2012" 
         src="/tests/polyClip-2.1/images/dad-2012.jpg" 
         alt="Dad 2012"  
         data-polyclip="0,0, 100,0, 50,273, -50,273" />
  </div>
</dt>
<dd class="wp-caption-dd">
<div>Move your mouse over (or slide your finger on) the image horizontally to see an example use-case of animated masking.  Photos used by kind permission of my father (and good sport) Jean Hawryluk.</div>
</dd>
</dl>
<p><strong><a href="http://www.useragentman.com/blog/2011/10/29/clipping-jpeg-images-into-non-rectangular-polygons-using-polyclip-js/">I first created polyClip.js</a> so I could combine the lossy compression algorithm of JPEGs with the ability to have a transparent area that PNGs allow.</strong>  The result works well in all browsers (including IE8 and below), but the creative people I work with wanted to be able to animate the clipping area to create some interesting visual effects.  Would polyClip.js be fast enough to <strong>change the clipping area on-the-fly and even animate it</strong> at reasonably fast speeds?  <strong>Could you even do CSS3-style transformations on the clipping areas</strong> (e.g. rotate and scale an existing clipping path)?  The answer is a resounding yes and it is <strong>really fast even in older IE as well</strong>, as you can see with the example on the left.  This article will discuss in detail how you can do this with polyClip and a related library, Silk.js (includes with polyClip) to do battery friendly and CPU efficient HTML5 animations. </p>
<p>Since this article talks about improvements and enhancements to my JavaScript library polyClip.js, <strong>you may first want to read my previous blog post, <a href="http://www.useragentman.com/blog/2011/10/29/clipping-jpeg-images-into-non-rectangular-polygons-using-polyclip-js/">Clipping JPEG Images Into Non-Rectangular Polygons Using polyClip.js</a></strong>.  All examples here are <a href="https://github.com/zoltan-dulac/polyClip">available for download at the polyClip github repository</a>.</p>
<div class="exampleLinkList cf">
<a class="exampleLink" href="/tests/polyClip-2.1/polyclip-animation-example-1.html">See a &#8220;clean room&#8221;, view-source friendly version with the above example.</a><br />
<a class="exampleLink" href="https://github.com/zoltan-dulac/polyClip">Download the latest version of polyClip.js and Silk.js from github.</a>
</div>
<h2>Clipping Images Dynamically With JavaScript</h2>
<p>Using polyClip.js 2.1, you can dynamically change the clip path of the image you are clipping by either changing the value of the <code>data-polyclip</code> attribute or by applying a transform to the existing clipping path.  It does this using <a href="https://developer.mozilla.org/en-US/docs/HTML/Canvas">HTML5 Canvas</a>.  In the above example, the clipping path of the colour image changes depending on the mouse pointer position.</p>
<p>How is this done?  First we must include the following <code>&lt;script&gt;</code> tags at the bottom of the <code>&lt;body&gt;</code>:</p>
<p></p>
<blockquote class="code">
<pre>
&lt;script src="js/libs/jquery-1.8.3.min.js"&gt;&lt;/script&gt;

&lt;!-- Canvas and HTML5 polyfills Needed for IE 8 and under --&gt;
&lt;!--[if lt IE 9 ]&gt;
	&lt;script src="js/libs/excanvas.compiled.js"&gt;&lt;/script&gt;
	&lt;script src="js/libs/html5.js"&gt;&lt;/script&gt;
&lt;![endif]--&gt;

&lt;!-- Needed to do transforms --&gt;
&lt;script src="js/libs/sylvester.js"&gt;&lt;/script&gt;

&lt;script src="js/polyclip-p.js"&gt;&lt;/script&gt;

</pre>
</blockquote>
<p>Next, we create two <code>&lt;img&gt;</code> tags: one regular one and one clipped to a small, angled strip of the original image.</p>
<blockquote class="code">
<pre>
&lt;div id="example1" class="clipParent"&gt;
    &lt;img id="dad1960" 
         src="/tests/polyClip-2.1/images/dad-circa-1960.jpg" 
         alt="Dad circa 1960" /&gt;
    &lt;img id="dad2012" 
         src="/tests/polyClip-2.1/images/dad-2012.jpg" 
         alt="Dad 2012"  
         data-polyclip="0,0, 100,0, 50,273, -50,273" /&gt;
&lt;/div&gt;
</pre>
</blockquote>
<p>Next, using jQuery, we bind <code>mouseover</code>, <code>touchmove</code> and <code>click</code> events to translate the clipping path to be underneath the event fired.  Let&#8217;s first look at a simple way of doing this in just a few lines of JavaScript:</p>
<blockquote class="code">
<pre>
var $dad2012;

function init() {
	// cache jQuery object of the clipped image
	$dad2012 = $('#dad2012');

	/*
	 * Setup mouse and touch events to translate the clipping path to be 
	 * underneath the event fired.  Note that we use the click event as 
	 * well -- although iOS Safari can keep up with the touchmove event,
	 * Android Chrome and "Browser" cannot, so use the click event as a
	 * type of fallback.
	 */
	$clipParent.bind({
		mousemove: mouseoverEvent,
		touchmove: mouseoverEvent,
		    click: mouseoverEvent
	});
}

function mouseoverEvent(e) {
	var pos = $clipParent.position();
	var x =  e.pageX - mouseOffset - $clipParent.get(0).offsetLeft;
		
	polyClip.transformClip($dad2012, 'translateX(' + x + 'px)');
}

polyClip.addCallback(init);
</pre>
</blockquote>
<p>Note that we call <code>init</code> <em>after</em> polyClip.js is initialized using <code>polyClip.addCallback()</code>.   Also note that <code>polyClip.transformClip()</code> takes two parameters.  The first is the jQuery object or a DOM object that you want to clip.  The second is a transform expression (in CSS3 <code>transform</code> syntax), that says where you want 2D transformations you want performed on the clipping region.  You can use <em>any</em> valid CSS3 2D transform function (or combination thereof), so you can skew, rotate and translate to your hearts content.</p>
<p>This is good, but we can make it even better!   For the example above, I used <code>requestAnimationFrame()</code> to make the animation even smoother.  I used <a href="http://my.opera.com/emoller/blog/2011/12/20/requestanimationframe-for-smart-er-animating">Erik MÃ¶ller&#8217;s <code>requestAnimationFrame()</code> shim</a> so that I didn&#8217;t have to &#8220;prefix-the-crap&#8221; out of my code. Here is the refactored version of the code:</p>
<blockquote class="code">
<pre>
var $dad2012,
    frameReq,
    hasGranularRequestAnimationFrame = 
        window.requestAnimationFrame &#038;& 
        requestAnimationFrame !== window.webkitRequestAnimationFrame &#038;&
        requestAnimationFrame.toString().indexOf('[native code]') > -1;;

function init() {
	// cache jQuery object of the clipped image
	$dad2012 = $('#dad2012');

	// set up mousemove event on that object
	$dad2012.mousemove(mouseoverEvent);
}

function mouseoverEvent(e) {
	
	/*
	 * We use requestAnimationFrame() here to make the animation
	 * smoother, if:
	 * 
	 * a) a native implementation (i.e. non-polyfill) is available.
	 * b) it is not WebkitRequestAnimationFrame.
	 * 
	 * Both the polyfill and WebkitRequestAnimationFrame slow down 
	 * the animation of the mouseover.
	 * 
	 */
	
	
	if (hasGranularRequestAnimationFrame) {
		if (frameReq) {
			cancelAnimationFrame(frameReq);
		}
		frameReq = requestAnimationFrame(
			function() { 
				animateClipRegion(e) 
			});
	} else {
		animateClipRegion(e);
	}
}

/*
 * This is the function that is used by the mouseoverEvent()
 * function to generate the clipping region underneath the
 * mouse pointer.
 */
function animateClipRegion(e) {	
	
	var pos = $clipParent.position();
	var x =  e.pageX - mouseOffset - $clipParent.get(0).offsetLeft;
	
	polyClip.transformClip($dad2012, 'translateX(' + x + 'px)');
	
	
}

polyClip.addCallback(init);
</pre>
</blockquote>
<p>As the code&#8217;s comments state: I only use <code>requestAnimationFrame()</code> if the browser has a native one available and the browser is not a WebKit based oen.  This is because at the time of this writing (Dec. 27th, 2012) both the polyfill and Webkit implementations of <code>requestAnimationFrame()</code> seems to make the animation lag behind the mouse a fair bit (with the polyfill, the effect is quite more pronounced).  This is probably because the animation is too granular for both implementations &mdash; definitely something I will be doing more research into.</p>
<p>(Note: if you look at the &#8220;clean room&#8221; view-source friendly code, you will see that I use a some extra housecleaning code to take into account the document structure of this blog.  I leave it out for sake of clarity).</p>
<p><a class="exampleLink" href="/tests/polyClip-2.1/polyclip-animation-example-1.html">See a &#8220;clean room&#8221;, view-source friendly version with the above example.</a></p>
<h2>More General Animations With requestAnimationFrame() Using Silk.js</h2>
<p>Let&#8217;s take a look at the next example below.  Click on the &#8220;next&#8221; button below and see the transition between the two photos.</p>


<div id="example2" class="clipParent">
	<img id="zoltan2012" src="/tests/polyClip-2.1/images/zoltan-2012.jpg" alt="Me, 2012" />
	<img id="zoltan2000" src="/tests/polyClip-2.1/images/zoltan-circa-2000.jpg" 
	    alt="Me at Doug's Wedding, circa 2000"  
		data-polyclip="-500,-150, 0,-150, 0,350, -500,350"  
		data-polyclip-transformorigin="0, 350" />
	<button id="next">Next</button>
</div>

<a class="exampleLink" href="/tests/polyClip-2.1/polyclip-animation-example-2.html">See a "clean room", view-source friendly version with the above example.</a>

How is this done?  First we must add a few more script tags to the bottom of our document:

<blockquote class="code">
<pre>
&lt;script src="js/libs/jquery-1.8.3.min.js"&gt;&lt;/script&gt;

<span class="hilite">&lt;!-- Needed for easing formulas to finesse the animation --&gt;
&lt;script src="js/libs/jquery.easing.1.3.js"&gt;&lt;/script&gt;</span>

&lt;!-- Canvas and HTML5 polyfills Needed for IE 8 and under --&gt;
&lt;!--[if lt IE 9 ]&gt;
	&lt;script src="js/libs/excanvas.compiled.js"&gt;&lt;/script&gt;
	&lt;script src="js/libs/html5.js"&gt;&lt;/script&gt;
&lt;![endif]--&gt;

&lt;!-- Needed to do transforms --&gt;
&lt;script src="js/libs/sylvester.js"&gt;&lt;/script&gt;

<span class="hilite">&lt;!-- Needed for Silk.js --&gt;
&lt;script src="js/libs/jshashtable-2.1.js"&gt;&lt;/script&gt;

&lt;!-- Needed for smooth animation --&gt;
&lt;script src="js/Silk.js"&gt;&lt;/script&gt;</span>
 
&lt;script src="js/polyclip-p.js"&gt;&lt;/script&gt;

</pre>
</blockquote>

Then we add the photos for the gallery with this HTML:

<blockquote class="code">
<pre>
&lt;div id="example2" class="clipParent"&gt;

  &lt;img id="zoltan2012" src="images/zoltan-2012.jpg" alt="Me, 2012" /&gt;

  &lt;img id="zoltan2000" src="images/zoltan-circa-2000.jpg" 
      alt="Me at Doug's Wedding, circa 2000"  
     <span class="hilite">data-polyclip="-500,-150, 0,-150, 0,350, -500,350" </span>  
     <span class="hilite">data-polyclip-transformorigin="0, 350"</span> /&gt;

  &lt;button id="next"&gt;Next&lt;/button&gt;

&lt;/div&gt;
</pre>
</blockquote>
<p>Just like the first example, we have two <code>&lt;img&gt;</code> tags. The bottom one (with has the photo of the very good looking fellow in the hat taken by <a href="https://twitter.com/iDVB">Dan Van Brunt</a>) is a regular image.  The other one (the photo of the dude with the great head of hair by <a href="http://luxography.ca">Brian Tao</a>) is an image clipped with polyClip.js.  As you can see from the second images&#8217;s <code>data-polyclip</code> attribute, the image is clipped outside of the image&#8217;s visible area:</p>
<p><div id="attachment_5688" style="width: 455px" class="wp-caption aligncenter"><img src="http://www.useragentman.com/blog/wp-content/uploads/2012/12/large-initial-state.jpg" alt="The initial state of the animation" width="445" height="266" class="size-full wp-image-5688" srcset="http://www.useragentman.com/blog/wp-content/uploads/2012/12/large-initial-state.jpg 445w, http://www.useragentman.com/blog/wp-content/uploads/2012/12/large-initial-state-300x179.jpg 300w" sizes="(max-width: 445px) 100vw, 445px" /><p class="wp-caption-text">The initial state of the animation.  Note that the clipping path of second image (outlined in purple) is <em>outside</em> the viewport of the image, which is why you don&#8217;t see the clipped image before the &#8220;Next&#8221; button is clicked.</p></div></p>
<p>This is why you cannot see &#8220;dude with the hair&#8221; image initially.  Note that we also set the <code>data-polyclip-transformorigin</code> attribute to <code>0, 350</code>, so that the clipping area rotates with respect to this point.</p>
<p>Now we want to rotate the clipping area so that we get the desired effect.  The slides below show what will happen when clipping area of the second image is rotated: </p>
<table class="dataTable">
<thead>
<tr>
<th>rotate(0deg)</th>
<th>rotate(20deg)</th>
<th>rotate(45deg)</th>
<th>rotate(70deg)</th>
</tr>
</thead>
<tbody>
<tr>
<td><img src="/tests/polyClip-2.1/images/rotationSlides/0deg.jpg" alt="unrotated clipped image"/></td>
<td><img src="/tests/polyClip-2.1/images/rotationSlides/20deg.jpg" alt="clipped image rotated 20 degrees"/></td>
<td><img src="/tests/polyClip-2.1/images/rotationSlides/45deg.jpg" alt="clipped image rotated 45 degrees"/></td>
<td><img src="/tests/polyClip-2.1/images/rotationSlides/70deg.jpg" alt="clipped image rotated 70 degrees"/></td>
</tr>
</tbody>
</table>
<p>All we have to do is set up a little JavaScript to make this magic action.  I use my own animation library, Silk.js to do the heavy lifting.  I could have used jQuery&#8217;s <code>animate()</code> method, but it doesn&#8217;t use requestAnimtionFrame to perform the animation, which does result in some noticable jitter (for more information on this, please read my earlier article, <a href="http://www.useragentman.com/blog/2012/09/23/cross-browser-gpu-acceleration-and-requestanimationframe-in-depth/">Cross Browser GPU Acceleration and requestAnimationFrame in Depth</a>) .  I made the API for Silk.js to closely resemble jQuery&#8217;s <code>animate()</code> method, so it should be fairly easy to follow what is going on in the code below.</p>

<blockquote class="code">
<pre>
var example2 = new function () {
   var me = this,
      $zoltan2000,
      mouseOffset = 20,
      visibleImage,
      animationDone = true;
   
   /* 
    * Initialize the animation.  Cache jQuery objects
    * and set up click event.
    */
   me.init = function () {
      $zoltan2000 = $('#zoltan2000');
      
      $next = $('#next');
      visibleImage = 'zoltan2012';
      
      $next.click(clickEvent);
      
   }
   
   
   function clickEvent(e) {
      
      // If there is an animation running, don't do anything.
      if (!animationDone) {
         return;
      }
      
      animationDone = false;
      
      // Disable the next button.
      $next.attr('disabled', true)
      
      /*
       * set up the start and end angle of the animation,
       * depending on the state of the animation.
       */
      var beginAngle, endAngle;
      if (visibleImage == 'zoltan2012') {
         beginAngle = 0;
         endAngle = 90;
      } else {
         beginAngle = 90;
         endAngle = 180;
      }
      
      /*
       * Call Silk.js to do the animation.  Let's go
       * through this step by step.
       */
      var animation = new Silk(null, null, {
         
         // start and index of the animation
         stepStart: beginAngle,
         stepEnd: endAngle,
         
         // How long the animation is to run.
         duration: 1000,
         
         // What to do when the animation completes.
         complete: function () {
            
            animationDone = true;
            $next.attr('disabled', false)
            
            if (visibleImage == 'zoltan2012') {
               visibleImage = 'zoltan2000';
            } else {
               visibleImage = 'zoltan2012';
            }
         },
         
         // What easing function to use
         easing: 'easeInOutCubic',
         
         /*
          * What to do at each step of the animation.  
          * Note that 'now' will be set to a number
          * between 'stepStart' and 'stepEnd', depending
          * where we are in the animation.
          */
         step: function (now) {
            polyClip.transformClip($zoltan2000, 'rotate(' + now + 'deg)');
         }
      });
      
   }
   
}

/*
 * Use this call instead of $(document).ready to initialize
 * to ensure that polyClip has initialized before you 
 * start the animation routines.
 */ 
polyClip.addCallback(example2.init);
</pre>
</blockquote>
<p>The ability to use any shape as a clipping area and transforming it dynamically can really spice up the clich&eacute; slideshow.  Below is an example that I used to promote a show for my band Conflicting Plaid:</p>
<p><div id="attachment_5700" style="width: 267px" class="wp-caption aligncenter"><a href="http://www.useragentman.com/tests/polyClip-2.1/conflicting-plaid.html"><img src="http://www.useragentman.com/blog/wp-content/uploads/2012/12/cf-screenshot.jpg" alt="Screenshot of an example of polyClip.js" width="257" height="257" class="size-full wp-image-5700" srcset="http://www.useragentman.com/blog/wp-content/uploads/2012/12/cf-screenshot.jpg 257w, http://www.useragentman.com/blog/wp-content/uploads/2012/12/cf-screenshot-150x150.jpg 150w" sizes="(max-width: 257px) 100vw, 257px" /></a><p class="wp-caption-text"><a class="exampleLink" href="http://www.useragentman.com/tests/polyClip-2.1/conflicting-plaid.html">See an example of an animation using large images being clipped.</a></p></div></p>
<h2>Animating Clipping Paths Without Transforms</h2>
<p>If you don&#8217;t want to deal with transforms, or your use-case doesn&#8217;t call for them, you can just manipulate the clipping area of the resultant <code>canvas</code> tag instead using <code>polyClip.clipImage()</code>.  Take a look at this example I used for my previous blog post, <a href="/blog/2012/09/23/cross-browser-gpu-acceleration-and-requestanimationframe-in-depth/">Cross Browser GPU Acceleration and requestAnimationFrame in Depth</a>: </p>

<div id="frameContainer">
<div id="frame">
			
			<img id="full-cast" src="/blog/wp-content/uploads/2012/08/Mod_Squad_cast_photo_1969-small.jpg" data-tagline="" data-polyclip="
				0, 0,
				0, 939, 
				726, 939, 
				726, 0"/>	
				
			<img id="clarence" src="/blog/wp-content/uploads/2012/08/Clarence_Williams_III_Mod_Squad_1971-color-small.jpg" data-tagline="Linc" data-polyclip="
				0, 0,
				0, 939, 
				726, 939, 
				726, 0"  />
			<img id="michael" src="/blog/wp-content/uploads/2012/08/Michael_Cole_Mod_Squad_1973-color-small.jpg" data-tagline="Peter" data-polyclip="
				0, 0,
				0, 939, 
				726, 939, 
				726, 0" />
			<img id="peggy" src="/blog/wp-content/uploads/2012/08/Peggy_Lipton_Mod_Squad-color-small.jpg" data-tagline="Julie" data-polyclip="
				0, 0,
				0, 939, 
				726, 939, 
				726, 0" />
			<div id="title"><div>Mod Squad</div></div>
			<div id="finalText">
				<h1>Mod Squad</h1>
				<p class="time"> TUESDAYS 8PM / 7 Central <img src="/blog/wp-content/uploads/2012/08/abc-vector-small.png" /></p>
				<p id="startAgain">Play Demo Again</p>
			</div>
			<div id="startDemo">Start Demo</div>
			</div>
		
		</div>
		<pre id="stats">
		</pre>
<p>When I coded these animations, I used <code>polyClip.clipImage()</code> to change the clipping region over time:</p>
<blockquote class="code">
<pre>
var $title = $('#title');

$title.css({
	top: 596
});

animation = new Silk($title, {
	top: -160
}, {
	<span class="hilite">stepStart: 719,</span>
	<span class="hilite">stepEnd: -35,</span>
	duration: 3000,
	complete: function () {
		complete();
	},
	easing: 'easeInOutCubic',
	step: function (now, fx) {
		
		$jNode = polyClip.clipImage($jNode, 
		            <span class="hilite">"0, " + now + ", 355, " + (now - 206) + "355, 459, 0, 0, 0"</span>);
	}
})
</pre>
</blockquote>
<p><strong>Note the first two parameters are not set to <code>null</code> as in the previous example.</strong>  This is because we are animating the HTML <code>&lt;div id="title"&gt;MOD SQUAD&lt;/div&gt;</code> to move at the same rate as the animation clipping is moving, starting at <code>top: 596</code> and ending at <code>top: -160</code>.  I will be writing more about the full functionality of Silk.js in a future blog post.  Obviously, the above animation manipulates several images &mdash; for more details, please view-source the clean-room, view-source friendly version of the page below:</p>
<p><a class="exampleLink" href="/tests/polyClip-2.1/modsquad.html">See a &#8220;clean room&#8221;, view-source friendly version with the above example.</a></p>
<h2>Clipping Images Using Canvas or SVG.</h2>
<p>As mentioned earlier, polyClip.js uses HTML5 Canvas to produce the clipped images.  Sometimes, however, it may be desirable to use SVG instead.   As of polyClip.js 2.0, you can now set the optional <code>data-polyclip-clippreference</code> attribute to tell the browser to use SVG <em>whenever possible</em>:</p>
<blockquote class="code">
<pre>
&lt;img src="image.jpg" data-polyclip="487, 4, 500, 239, 19, 239, 43, 195"
      <span class="hilite">data-polyclip-clippreference="SVG"</span>  /&gt;
</pre>
</blockquote>
<p><strong></p>
<p>Note that I say &#8220;whenever possible&#8221;.</strong>.  This is because, at the time of this writing, there is a bug in iOS that will not correctly fill a SVG shape with an image correctly.  As I had mentioned in a previous blog post,  <a href="/blog/2012/09/23/cross-browser-gpu-acceleration-and-requestanimationframe-in-depth/#filled-svg-polygon-bug"><strong><em>all</em> current iOS devices</strong> I tested with (iPhone and iPad) have a severe bug when <strong>filling an SVG <code>polygon</code> with an image</strong></a>.  In order to fix this, I do a browser sniff to work around this iOS defect (I wish there was a way to detect this some other way, but I haven&#8217;t found one).  When this issue is fixed in iOS, I will change polyClip.js to only do this in the versions of iOS affected.  IE8 and below will, of course, always use excanvas.js and VML to draw the clipped images, due to their lack of support of SVG.</p>
<p>I recommend using Canvas by default.  I have found animating with SVG much slower and in some cases, can affect animations that appear elsewhere in the document.  I will post more information about that in another post.</p>
<h2>In Conclusion</h2>
<p>I have been using polyClip a lot in client work recently, and it works really well.  Combined with Silk.js, it makes for some interesting animations that look great even on an iPad and other mobile devices.  There are some more features about this library that I haven&#8217;t touched on yet which will be covered in future blog posts, so please stay tuned.</p>
<p><a class="exampleLink" href="https://github.com/zoltan-dulac/polyClip">Download the latest version of polyClip.js and Silk.js from github.</a></p>
							</div>
			<p class="tagged"><strong>Tags:</strong> <a href="http://www.useragentman.com/blog/category/technologies/javascript/animation/" rel="category tag">animation</a> &middot; <a href="http://www.useragentman.com/blog/category/technologies/html/html5/canvas/" rel="category tag">canvas</a> &middot; <a href="http://www.useragentman.com/blog/category/technologies/html/html5/" rel="category tag">HTML5</a> &middot; <a href="http://www.useragentman.com/blog/category/technologies/images/" rel="category tag">Images</a> &middot; <a href="http://www.useragentman.com/blog/category/technologies/javascript/" rel="category tag">JavaScript</a> &middot; <a href="http://www.useragentman.com/blog/category/technologies/javascript/jquery/" rel="category tag">jQuery</a> &middot; <a href="http://www.useragentman.com/blog/category/technologies/javascript/requestanimationframe/" rel="category tag">requestAnimationFrame</a> &middot; <a href="http://www.useragentman.com/blog/category/technologies/css/css3/transform/" rel="category tag">transform</a>  &middot; <a href="http://www.useragentman.com/blog/tag/clipping/" rel="tag">clipping</a>, <a href="http://www.useragentman.com/blog/tag/image-masking/" rel="tag">image masking</a>, <a href="http://www.useragentman.com/blog/tag/masking/" rel="tag">masking</a>, <a href="http://www.useragentman.com/blog/tag/polyclip/" rel="tag">polyClip</a>, <a href="http://www.useragentman.com/blog/tag/polygon-clipping/" rel="tag">polygon clipping</a>, <a href="http://www.useragentman.com/blog/tag/polygons/" rel="tag">polygons</a></p>
			<!-- <div class="clear"></div> -->

			
<!-- You can start editing here. -->


<div id="comments">

	<h6 class="comments_headers">0 responses so far <img src="http://www.useragentman.com/blog/wp-content/themes/useragentman/images/widgets/downArrow.png" 
	alt="&darr;" /></h6>
	
	<ul id="comment_list">

	
		 
			<!-- If comments are open, but there are no comments. -->
		
	</ul>

	

	<!-- Comment Form -->
		
		
			<h6 id="respond" class="comments_headers">Give Feedback</h6>

			<br />
			<!--
			<div class="importantNotes">
			<h3>Comment Section is Temporarily Down</h3>

			<p>There is something <strong>really</strong> wrong with the comments
			area of my website.  I will fix it as fast as I can, given the limits my day job provides :-).
			Your comments are <strong>extremely</strong> important to me, so please feel free to email me at <a 			href="mailto:zoltan.dulac@gmail.com">zoltan.dulac@gmail.com</a> or 
tweet me at my @zoltandulac twitter account ... I really appreciate any feedback you have!
I will post your comments back here when I bring it back on line.
			I hope you enjoy reading my blog my apologies for my technical difficulties. :-)</p>
			</div>
-->
			<p>Don't be shy! Give feedback and
			join the discussion.</p>
			
			<p><strong>Please Note:</strong> If you are asking for help using the information on this page or if you are reporting a bug with the code featured here, 
			please include a URL that shows the problem you are experiencing along with the browser/version number/operating system 
			combination where the issue manifests itself.  Without this information, I may not be able to respond.</p>

			<p><img src="http://www.useragentman.com/blog/wp-content/uploads/2012/04/asterisk_orange.png" alt="An orange star" /> denotes a required field.</p>

			<form action="http://www.useragentman.com/blog/wp-comments-post.php" method="post" id="comment_form" class="testValidity styleBubbleExample visibleIf-submitInvisibleData" data-webforms2-force-js-validation="true">
			
										<p><input class="text_input" type="text" required="required" name="author" id="author" value="" /><label for="author"><strong>Name</strong></label></p>
				<p><input class="text_input" type="email" required="required" name="email" id="email" value="" /><label for="email"><strong>Mail</strong></label></p>
				<p><input class="text_input" type="url" name="url" id="url" value="" /><label for="url"><strong>Website</strong></label></p>
							
			
				<p><textarea required="required" data-error-message="You forgot your comment!  :-) " class="text_input text_area" name="comment" id="comment" rows="7" ></textarea></p>
			
							
				<p>
					<input name="submit" class="form_submit" type="submit" id="submit" src="http://www.useragentman.com/blog/wp-content/themes/useragentman/images/submit_comment.gif" value="Submit" />
					<input type="hidden" name="comment_post_ID" value="5621" class="visibleIf-submitInvisibleData" />
				</p>
		
				<p style="display: none;"><input type="hidden" id="akismet_comment_nonce" name="akismet_comment_nonce" value="9e2f12cf73" /></p>	
			</form>

		
</div> <!-- Close #comments container -->
<div class="clear flat"></div>

		
		</div>

		
	</div>


<div id="foot" class="designElement">
		<p>&copy; 2009 - 2012 &mdash; Zoltan "Du Lac" Hawryluk <!-- <a href="http://www.useragentman.com/blog/sitemap/">Sitemap</a> &mdash;  &mdash; <a href="http://www.useragentman.com/blog/terms/">Terms of Use</a>&nbsp; &nbsp;--></p>
		<script type='text/javascript' src='http://www.useragentman.com/blog/wp-includes/js/wp-embed.min.js?ver=4.7.5'></script>
		
	</div>
	
	</div>
	</div>
</body>
</html>
